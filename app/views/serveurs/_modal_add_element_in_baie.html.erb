<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Ajouter un élément</h4>
      </div>
      <div class="modal-body">
        <%= form_for(Serveur.new(:nom => "PatchPanel", :modele => Modele.where("title LIKE ?", '%Panel%').first, :salle => @salle), html: { class: "form-horizontal", role: "form" }) do |f| %>
          <% if @serveur.try(:errors).try(:any?) %>
            <div class="alert alert-danger alert-dismissable" role="alert">
              <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
              <h4><%= pluralize(@serveur.errors.count, "error") %> prohibited this serveur from being saved:</h4>

              <ul>
                <% @serveur.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div class="form-group">
            <%= f.label :nom, class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <%= f.text_field :nom, class: "form-control" %>
            </div>
          </div>
          <div class="form-group">
            <%= f.label :modele_id, class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <%= f.collection_select(:modele_id, Modele.order(:title), :id, :title, {:prompt => true}, {class: "form-control"}) %>
            </div>
          </div>

          <div class="form-group">
            <%= f.label :salle_id, class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <%= f.collection_select(:salle_id, Salle.all, :id, :title, {:prompt => true}, {class: "form-control"}) %>
            </div>
          </div>
          <div class="form-group">
            <%= f.label :ilot, class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <%= f.number_field :ilot, class: "form-control" %>
            </div>
          </div>

          <div class="form-group">
            <%= f.label :baie, class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <%= f.collection_select(:baie_id, Baie.includes(:salle).sorted, :id,:name_with_salle_and_ilot, {:prompt => true}, {class: "form-control"}) %>
            </div>
          </div>

          <div class="form-group">
            <%= f.label :position, class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <%= f.number_field :position, class: "form-control" %>
            </div>
          </div>

          <% if f.object.persisted? && @serveur.modele%>
            <%= content_tag :span, 'Slots', class: "col-sm-2 control-label" %>
            <div class="col-sm-10">
              <div class="panel panel-default">
                <ul class="list-group">
                  <%= f.fields_for :cards_serveurs do |builder| %>

                    <%= render "cards_serveur_fields", :f => builder %>

                  <% end %>
                </ul>
                <div class="panel-footer"><%= link_to_add_fields "<span class='glyphicon glyphicon-plus' aria-hidden='true'></span> Ajouter une carte".html_safe, f, :cards_serveurs %></div>
              </div>
            </div>
          <% end %>

          <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
              <%= f.submit class: "btn btn-primary" %>
              <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
            </div>
          </div>
        <% end %>

      </div>
    </div>
  </div>
</div>
